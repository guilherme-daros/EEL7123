def ModuleCalc(number):
    r = []
    bitLength = len(bin(number)[2:])
    for i in range(10):
        r.append(2**(bitLength + i) - number)
    return r

def onesCounter(x):
    i = 0
    y = "".join(x)
    for j in y:
        if j == "1":
            i+=1
    return i

def FirstOrderBoothRecoding(n):
    n_ = [int(x) for x in list(n + "0")]
    r = []
    for i in range(len(n)):
        x = n_[i+1] - n_[i]
        if x == -1: r.append("-1")
        else:       r.append(str(x))
    return r

def SecondOrderBoothRecoding(x):
    for i in range(len(x) - 1):
        if (f'{x[i]}{x[i+1]}') == "-11":
            x[i] = "0"
            x[i+1] = "-1"
        elif(f'{x[i]}{x[i+1]}') == "1-1":
            x[i] = "0"
            x[i+1] = "1"
    return x

def ThirdOrderBoothRecoding(x):
    for i in range(len(x) - 1):
        if (f'{x[i]}{x[i+1]}') == "11":
            x[i-1] = "1"
            x[i] = "0"
            x[i+1] = "-1"
    return x

RSA = { 
    'RSA100': 1522605027922533360535618378132637429718068114961380688657908494580122963258952897654000350692006139,
    'RSA110': 35794234179725868774991807832568455403003778024228226193532908190484670252364677411513516111204504060317568667,
    'RSA120': 227010481295437363334259960947493668895875336466084780038173258247009162675779735389791151574049166747880487470296548479,
    'RSA129': 114381625757888867669235779976146612010218296721242362562561842935706935245733897830597123563958705058989075147599290026879543541,
    'RSA130': 1807082088687404805951656164405905566278102516769401349170127021450056662540244048387341127590812303371781887966563182013214880557,
    'RSA140': 21290246318258757547497882016271517497806703963277216278233383215381949984056495911366573853021918316783107387995317230889569230873441936471,
    'RSA150': 155089812478348440509606754370011861770654545830995430655466945774312632703463465954363335027577729025391453996787414027003501631772186840890795964683,
    'RSA155': 10941738641570527421809707322040357612003732945449205990913842131476349984288934784717997257891267332497625752899781833797076537244027146743531593354333897
    }

with open("out.csv","w") as file:
    
    for Number in RSA:
        file.write(f"{Number}\n")
        for item in ModuleCalc(RSA[Number]):
            x = FirstOrderBoothRecoding(bin(item)[2:])
            y = SecondOrderBoothRecoding(x)
            z = ThirdOrderBoothRecoding(y)
            file.write(str(onesCounter(z)))
            file.write("\n")
    